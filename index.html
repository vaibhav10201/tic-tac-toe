<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Smart Tic Tac Toe</title>
  <style>
    * { box-sizing: border-box; }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #4b4b4b, #50e3c2);
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 40px 20px;
      height: 100vh;
      margin: 0;
      color: #fff;
      overflow-x: hidden;
      user-select: none;
    }
    h1 {
      font-size: 3rem;
      margin-bottom: 10px;
      text-shadow: 2px 2px 5px rgba(0,0,0,0.3);
    }
    #status {
      font-size: 1.5rem;
      margin-bottom: 10px;
      font-weight: 600;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
      min-height: 2em;
    }
    #modeSelect {
      margin-bottom: 20px;
      padding: 8px 16px;
      border-radius: 20px;
      font-size: 1rem;
      border: none;
      background: #fff;
      color: #50e3c2;
      font-weight: bold;
      box-shadow: 0 0 10px #50e3c2;
      cursor: pointer;
    }
    #game {
      display: grid;
      grid-template-columns: repeat(3, 120px);
      grid-template-rows: repeat(3, 120px);
      gap: 10px;
      position: relative;
    }
    .cell {
      background: rgba(255 255 255 / 0.15);
      border-radius: 15px;
      box-shadow: inset 0 4px 7px rgb(255 255 255 / 0.3), 0 8px 15px rgb(0 0 0 / 0.25);
      font-size: 4rem;
      color: #fff;
      display: flex;
      justify-content: center;
      align-items: center;
      cursor: pointer;
      transition: background-color 0.3s ease;
      font-weight: 900;
      text-shadow: 0 0 6px #fff, 0 0 10px #50e3c2, 0 0 20px #50e3c2;
    }
    .cell:hover { background: rgba(255 255 255 / 0.35); }
    #resetBtn {
      margin-top: 30px;
      padding: 12px 30px;
      font-size: 1.3rem;
      font-weight: 700;
      color: #50e3c2;
      background: #fff;
      border: none;
      border-radius: 30px;
      cursor: pointer;
      box-shadow: 0 0 15px #50e3c2;
      transition: background-color 0.3s ease, color 0.3s ease;
    }
    #resetBtn:hover {
      background: #50e3c2;
      color: white;
      box-shadow: 0 0 25px #50e3c2;
    }
    #winning-line {
      position: absolute;
      background: linear-gradient(90deg, #fff, #50e3c2, #fff);
      border-radius: 10px;
      box-shadow: 0 0 15px #50e3c2;
      pointer-events: none;
      opacity: 0;
      transform-origin: center;
      z-index: 10;
    }
    #fireworks {
      position: fixed;
      top: 0; left: 0;
      width: 100vw; height: 100vh;
      pointer-events: none;
      z-index: 1000;
    }
    .firework-particle {
      position: absolute;
      width: 6px;
      height: 6px;
      border-radius: 50%;
      pointer-events: none;
      opacity: 1;
      animation: flyAndFade 1.2s forwards;
    }
    @keyframes flyAndFade {
      0% { transform: translate(0, 0) scale(1); opacity: 1; }
      100% { transform: translate(var(--x), var(--y)) scale(0); opacity: 0; }
    }
  </style>
</head>
<body>
  <h1>Tic Tac Toe</h1>
  <div id="status">Player X's turn</div>
  <select id="modeSelect">
    <option value="human">2 Players</option>
    <option value="computer-easy">Play vs Computer (Easy)</option>
    <option value="computer-medium">Play vs Computer (Medium)</option>
    <option value="computer-hard">Play vs Computer (Hard)</option>
  </select>
  <div id="game">
    <div class="cell" data-index="0"></div>
    <div class="cell" data-index="1"></div>
    <div class="cell" data-index="2"></div>
    <div class="cell" data-index="3"></div>
    <div class="cell" data-index="4"></div>
    <div class="cell" data-index="5"></div>
    <div class="cell" data-index="6"></div>
    <div class="cell" data-index="7"></div>
    <div class="cell" data-index="8"></div>
    <div id="winning-line"></div>
  </div>
  <button id="resetBtn">Restart Game</button>
  <div id="fireworks"></div>

  <script>
    const cells = document.querySelectorAll('.cell');
    const status = document.getElementById('status');
    const resetBtn = document.getElementById('resetBtn');
    const winningLine = document.getElementById('winning-line');
    const fireworksContainer = document.getElementById('fireworks');
    const modeSelect = document.getElementById('modeSelect');

    let board = Array(9).fill('');
    let currentPlayer = 'X';
    let gameActive = true;
    let computerLevel = null;

    const winningPatterns = [
      { combo: [0,1,2], line: {x: 0, y: 60, w: 370, h: 6, rot: 0} },
      { combo: [3,4,5], line: {x: 0, y: 180, w: 370, h: 6, rot: 0} },
      { combo: [6,7,8], line: {x: 0, y: 300, w: 370, h: 6, rot: 0} },
      { combo: [0,3,6], line: {x: 60, y: 0, w: 6, h: 370, rot: 0} },
      { combo: [1,4,7], line: {x: 180, y: 0, w: 6, h: 370, rot: 0} },
      { combo: [2,5,8], line: {x: 300, y: 0, w: 6, h: 370, rot: 0} },
      { combo: [0,4,8], line: {x: 0, y: 205, w: 420, h: 6, rot: 45} },
      { combo: [2,4,6], line: {x: -20, y: 200, w: 420, h: 6, rot: -45} }
    ];

    modeSelect.addEventListener('change', () => {
      const value = modeSelect.value;
      computerLevel = value.includes('computer') ? value.split('-')[1] : null;
      resetGame();
    });

    cells.forEach(cell => cell.addEventListener('click', handleCellClick));
    resetBtn.addEventListener('click', resetGame);

    function handleCellClick(e) {
      const index = e.target.getAttribute('data-index');
      if (board[index] !== '' || !gameActive) return;

      makeMove(index, currentPlayer);

      const winInfo = checkWin();
      if (winInfo) {
        status.textContent = `Player ${currentPlayer} Wins! ðŸŽ‰`;
        gameActive = false;
        drawWinningLine(winInfo.line);
        launchFireworks();
        return;
      }

      if (board.every(cell => cell !== '')) {
        status.textContent = "It's a draw!";
        gameActive = false;
        return;
      }

      currentPlayer = currentPlayer === 'X' ? 'O' : 'X';
      status.textContent = `Player ${currentPlayer}'s turn`;

      if (computerLevel && currentPlayer === 'O') {
        setTimeout(computerMove, 500);
      }
    }

    function makeMove(index, player) {
      board[index] = player;
      cells[index].textContent = player;
    }

    function computerMove() {
      let move;

      if (computerLevel === 'easy') {
        move = easyMove();
      } else if (computerLevel === 'medium') {
        move = mediumMove();
      } else if (computerLevel === 'hard') {
        move = hardMove(board.slice(), 'O').index;
      }

      if (move !== undefined) {
        makeMove(move, 'O');

        const winInfo = checkWin();
        if (winInfo) {
          status.textContent = `Computer Wins! ðŸ’»`;
          gameActive = false;
          drawWinningLine(winInfo.line);
          launchFireworks();
          return;
        }

        if (board.every(cell => cell !== '')) {
          status.textContent = "It's a draw!";
          gameActive = false;
          return;
        }

        currentPlayer = 'X';
        status.textContent = `Player ${currentPlayer}'s turn`;
      }
    }

    function easyMove() {
      let available = board.map((v, i) => v === '' ? i : null).filter(v => v !== null);
      return available[Math.floor(Math.random() * available.length)];
    }

    function mediumMove() {
      for (let i = 0; i < board.length; i++) {
        if (board[i] === '') {
          board[i] = 'O';
          if (checkWin()) { board[i] = ''; return i; }
          board[i] = '';
        }
      }
      for (let i = 0; i < board.length; i++) {
        if (board[i] === '') {
          board[i] = 'X';
          if (checkWin()) { board[i] = ''; return i; }
          board[i] = '';
        }
      }
      return easyMove();
    }

    function hardMove(newBoard, player) {
      const availSpots = newBoard.map((v, i) => v === '' ? i : null).filter(v => v !== null);
      if (checkWinner(newBoard, 'X')) return { score: -10 };
      if (checkWinner(newBoard, 'O')) return { score: 10 };
      if (availSpots.length === 0) return { score: 0 };

      const moves = [];

      for (let i = 0; i < availSpots.length; i++) {
        let move = {};
        move.index = availSpots[i];
        newBoard[availSpots[i]] = player;

        let result = player === 'O' ? hardMove(newBoard, 'X') : hardMove(newBoard, 'O');
        move.score = result.score;

        newBoard[availSpots[i]] = '';
        moves.push(move);
      }

      let bestMove;
      if (player === 'O') {
        let bestScore = -Infinity;
        for (let i = 0; i < moves.length; i++) {
          if (moves[i].score > bestScore) {
            bestScore = moves[i].score;
            bestMove = i;
          }
        }
      } else {
        let bestScore = Infinity;
        for (let i = 0; i < moves.length; i++) {
          if (moves[i].score < bestScore) {
            bestScore = moves[i].score;
            bestMove = i;
          }
        }
      }

      return moves[bestMove];
    }

    function checkWinner(b, p) {
      return winningPatterns.some(pattern => {
        const [a, b1, c] = pattern.combo;
        return b[a] === p && b[b1] === p && b[c] === p;
      });
    }

    function checkWin() {
      for (const pattern of winningPatterns) {
        const [a, b, c] = pattern.combo;
        if (board[a] && board[a] === board[b] && board[a] === board[c]) {
          return pattern;
        }
      }
      return null;
    }

    function drawWinningLine(line) {
      winningLine.style.opacity = 1;
      winningLine.style.width = line.w + 'px';
      winningLine.style.height = line.h + 'px';
      winningLine.style.left = line.x + 'px';
      winningLine.style.top = line.y + 'px';
      winningLine.style.transform = `rotate(${line.rot}deg)`;
    }

    function resetGame() {
      board.fill('');
      cells.forEach(cell => cell.textContent = '');
      currentPlayer = 'X';
      gameActive = true;
      status.textContent = `Player ${currentPlayer}'s turn`;
      winningLine.style.opacity = 0;
      clearFireworks();
    }

    function launchFireworks() {
      const count = 40;
      for (let i = 0; i < count; i++) createFireworkParticle();
      let intervalId = setInterval(() => {
        for (let i = 0; i < count; i++) createFireworkParticle();
      }, 700);
      setTimeout(() => clearInterval(intervalId), 3500);
    }

    function createFireworkParticle() {
      const particle = document.createElement('div');
      particle.classList.add('firework-particle');
      particle.style.background = randomColor();
      const centerX = window.innerWidth / 2;
      const centerY = window.innerHeight / 2;
      particle.style.left = centerX + 'px';
      particle.style.top = centerY + 'px';
      const x = (Math.random() - 0.5) * 300 + 'px';
      const y = (Math.random() - 0.5) * 300 + 'px';
      particle.style.setProperty('--x', x);
      particle.style.setProperty('--y', y);
      fireworksContainer.appendChild(particle);
      particle.addEventListener('animationend', () => particle.remove());
    }

    function randomColor() {
      const colors = ['#FF3F8E', '#04C2C9', '#2E55C1', '#F9ED69', '#F08A5D', '#B83B5E', '#6A0572'];
      return colors[Math.floor(Math.random() * colors.length)];
    }

    function clearFireworks() {
      fireworksContainer.innerHTML = '';
    }
  </script>
</body>
</html>
